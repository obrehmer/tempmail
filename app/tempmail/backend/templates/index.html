<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="index, follow">
  <meta name="description" content="Get a free disposable temporary email address valid for 2 minutes. Instantly receive emails without signing up.">
  <meta name="keywords" content="temporary email, disposable email, 2-minute mail, free email, no signup, temp inbox">
  <meta name="author" content="2-minute mail">
  <title>2-minute mail - Free Disposable Temporary Email</title>
</head>
<body>
  <h1>Your temporary email address:</h1>
  <p>
    <strong>{{ email }}</strong>
    <br>
    {% if remaining_minutes <= 0 and remaining_seconds <= 0 %}
      <strong>The email address has expired. A new one has been created.</strong>
    {% else %}
      <p>This email address is only valid for 2 minutes. Remaining time: <span id="countdown-timer"></span></p>
    {% endif %}
  </p>

  <button onclick="location.reload()">ðŸ”„ Refresh inbox</button>
  <h2>Inbox:</h2>
  <ul>
    {% for mail in emails %}
      <li>
        <strong>From: {{ mail.from }}</strong><br>
        <a href="{{ url_for('view_email', email_id=email_id, filename=mail['filename']) }}">
          {{ mail.subject }}
        </a>
      </li>
    {% else %}
      <li>No messages.</li>
    {% endfor %}
  </ul>
</body>

<script>
  // Get the remaining timer value from the session in seconds
  let remainingTime = {{ session['remaining_time'] | default(0) }};
  let timerElement = document.getElementById('countdown-timer');

  function updateTimer() {
    // Calculate the remaining minutes and seconds (integers only)
    const minutes = Math.floor(remainingTime / 60);  // Calculate minutes
    const seconds = Math.floor(remainingTime % 60);  // Calculate seconds

    // Display in the format "minutes and seconds"
    timerElement.innerText = `${minutes} minute${minutes !== 1 ? 's' : ''} and ${seconds} second${seconds !== 1 ? 's' : ''}`;

    // If time has expired
    if (remainingTime <= 0) {
      timerElement.innerText = "Expired";
      setTimeout(() => {
        window.location.href = '/';  // Reload page and generate new email
      }, 1000);
      return;
    }

    // Decrease the time by 1 every second
    remainingTime--;
    setTimeout(updateTimer, 1000);
  }

  updateTimer();
</script>

</html>

